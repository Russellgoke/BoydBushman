import pandas as pd
import matplotlib.pyplot as plt
import io

data_str = """100,638.41,24.13,685.35,734.07,727.49,727.80,681.47,25.07
200,638.05,23.69,685.21,734.42,727.11,727.97,680.90,24.51
300,637.11,24.92,684.82,734.43,727.66,728.37,680.71,25.35
400,636.71,23.51,685.05,735.42,727.32,727.43,680.07,24.67
500,636.76,23.88,685.36,734.57,727.21,728.15,679.57,24.93
600,636.58,23.89,685.20,734.77,727.13,727.95,679.50,24.70
700,636.38,23.91,685.16,734.52,727.30,728.22,679.48,24.67
900,637.18,23.64,685.35,734.93,727.06,727.84,679.91,24.84
1100,636.61,22.93,684.70,727.82,725.86,717.69,679.74,24.05
1200,637.00,23.25,685.23,735.00,727.16,727.72,679.98,24.48
1300,636.99,23.53,685.34,734.74,727.19,727.63,679.88,24.53
1400,636.88,23.74,685.37,734.55,727.21,727.94,679.69,24.48
1500,636.94,23.58,685.18,734.16,727.14,728.20,679.87,24.51
1600,636.81,23.79,685.03,734.93,727.32,727.64,680.11,24.47
1700,636.99,23.54,685.50,734.51,727.07,727.67,679.59,24.57
1800,636.37,23.82,685.18,734.75,727.36,727.85,679.53,24.43
1900,636.15,23.46,684.80,734.51,727.56,727.81,679.96,24.50
2000,636.86,23.64,685.38,734.35,727.26,728.01,679.71,24.64
2100,636.91,23.50,685.12,735.08,727.30,727.45,680.17,24.59
2200,637.14,23.36,685.52,734.62,727.05,727.87,679.70,24.76
2300,637.55,23.86,685.47,734.61,727.06,728.01,680.07,24.55
2400,637.68,23.28,685.38,734.38,727.12,728.00,680.40,24.60
2500,637.57,23.12,685.20,735.09,727.21,727.85,680.58,24.60
2600,637.38,22.69,685.06,735.81,726.74,727.03,680.26,24.10
2700,636.12,24.24,682.92,734.95,724.18,728.40,678.30,24.88
2800,635.68,24.25,682.56,732.86,724.40,728.94,678.35,24.20
2900,635.02,24.00,682.71,734.89,724.43,728.38,677.72,24.84
3000,636.34,24.03,682.61,734.08,724.45,728.47,679.07,24.51
3100,635.43,23.27,682.46,735.26,724.42,728.61,678.40,25.64
3200,635.55,24.68,683.02,735.28,724.07,728.37,677.50,24.62
3300,636.44,23.34,683.47,735.51,723.52,728.42,677.49,25.54
3400,635.70,24.98,682.05,732.43,725.08,731.18,679.11,24.71
3500,636.13,24.18,682.98,734.78,724.14,728.53,678.18,25.07
3600,635.67,23.87,682.77,735.41,724.11,727.90,678.06,24.94
3700,635.64,23.84,682.72,735.04,724.16,728.22,678.07,25.03
3800,635.34,23.89,682.86,734.98,724.21,728.36,677.67,24.83
3900,635.04,23.63,682.61,735.22,724.38,728.07,677.87,24.99
4000,635.24,23.87,682.65,734.89,724.25,728.23,677.86,24.81
4100,635.22,23.94,682.72,735.09,724.30,728.25,677.79,24.69
4200,634.98,23.91,682.51,735.17,724.41,728.17,677.90,24.77
4300,635.14,24.09,682.71,734.88,724.35,728.47,677.72,25.04
4400,634.79,24.06,682.40,734.60,724.47,728.34,677.83,24.59
4500,634.73,24.22,682.35,735.12,724.41,728.22,677.77,24.93
4600,634.59,23.51,682.57,735.22,724.46,728.13,677.57,25.50
4700,634.83,23.92,682.86,734.90,724.29,728.39,677.25,25.03
4800,634.28,23.87,682.25,734.79,724.59,728.34,677.63,24.81
4900,634.39,23.86,682.43,735.06,724.51,728.28,677.49,24.86
5000,634.41,23.85,682.75,735.34,724.57,728.25,677.25,25.19
5100,634.44,23.85,682.43,734.97,724.31,728.16,677.37,24.91
5200,634.53,24.13,682.52,734.88,724.57,728.48,677.55,24.68
5300,634.78,24.03,682.61,734.73,724.42,728.53,677.55,24.55
5400,634.74,24.02,682.22,734.88,724.63,728.45,678.13,24.82
5500,634.74,23.82,682.32,734.71,724.47,728.51,677.87,24.95
5600,635.69,20.70,683.59,735.65,723.61,728.15,677.07,26.48
5800,634.39,23.65,682.23,734.84,724.67,728.33,677.86,25.05
5900,634.84,24.48,682.09,734.00,724.63,728.77,678.24,24.45
6000,634.44,23.91,682.41,735.00,724.51,728.34,677.56,24.73
6100,634.27,23.96,682.39,734.91,724.63,728.36,677.50,24.83
6200,634.23,23.96,682.41,734.56,724.53,728.41,677.35,24.59
6300,633.91,23.94,682.19,734.72,724.73,728.67,677.41,24.88
6400,634.38,23.95,682.35,734.57,724.52,728.50,677.54,24.66
6500,634.09,23.80,682.37,735.22,724.56,728.26,677.33,24.79
6600,634.12,23.82,682.36,734.90,724.57,728.34,677.35,24.83
6700,634.06,24.27,682.43,735.18,724.56,728.33,677.17,24.77
6800,635.08,24.00,682.38,734.99,724.38,728.43,678.03,24.82
6900,634.99,23.91,682.27,734.79,724.41,728.51,678.09,24.90
7000,634.99,24.17,682.44,734.75,724.39,728.51,677.86,24.79
7100,634.44,24.02,682.35,734.76,724.57,728.46,677.63,24.63
7200,634.94,23.63,682.39,735.23,724.31,728.26,677.88,25.14
7300,634.30,22.81,681.86,735.79,724.58,727.78,678.23,25.49
7400,635.03,23.98,682.45,734.96,724.39,728.40,677.93,24.66
7500,634.18,23.98,682.20,734.75,724.59,728.42,677.57,24.71
7600,634.64,24.29,682.39,735.09,724.42,728.36,677.64,24.64
7700,634.30,23.93,682.32,735.30,724.48,728.09,677.51,24.93
7800,634.42,23.97,682.40,734.84,724.46,728.46,677.46,24.68
7900,633.66,24.05,682.12,734.67,724.75,728.65,677.26,24.83
8000,634.12,24.82,682.35,735.21,724.59,728.39,677.29,24.78
8100,634.19,23.31,682.48,735.55,724.45,728.18,677.29,26.31
8200,634.17,23.63,682.29,735.18,724.53,728.23,677.49,25.22
8300,634.19,23.55,682.32,735.23,724.51,728.21,677.46,25.19
8400,634.24,23.56,682.39,735.52,724.45,728.30,677.37,25.84
8500,634.27,23.89,682.36,735.20,724.55,728.44,677.48,24.98
8600,635.69,23.80,682.46,735.41,724.30,728.18,678.53,25.35
8700,635.32,23.78,682.72,735.38,724.14,728.22,677.75,25.12
8800,635.93,23.72,682.83,735.43,723.96,728.09,678.08,25.35
8900,635.61,24.15,682.24,734.73,724.56,728.68,678.81,24.63
9000,635.48,24.05,682.78,735.43,724.12,728.31,677.82,24.84
9100,635.05,24.21,682.75,735.29,724.32,728.50,677.57,24.93
9200,635.15,24.21,682.82,734.47,724.18,728.70,677.44,24.50
9300,635.08,23.88,682.59,735.20,724.20,728.35,677.70,25.20
9400,634.49,23.90,682.23,734.83,724.64,728.99,677.83,25.38
9500,634.56,23.89,682.38,735.45,724.55,728.46,677.75,25.39
9600,634.74,24.05,682.80,735.46,724.22,728.35,677.18,24.96
9700,634.41,23.80,682.29,735.46,724.55,728.37,677.72,25.16
9800,634.81,25.76,682.43,734.98,724.56,728.96,677.68,24.90
9900,634.17,23.88,682.21,735.54,724.64,728.28,677.68,25.00
10000,634.99,24.03,682.58,735.15,724.33,728.47,677.74,24.77
10100,635.13,24.48,682.67,734.25,724.50,729.06,677.80,24.37
10200,635.24,23.86,682.38,734.93,724.28,728.27,678.17,24.87
10300,634.96,24.00,682.55,735.22,724.40,728.51,677.81,25.24
10400,635.04,24.21,682.53,734.98,724.49,728.62,677.96,24.79
10500,634.69,24.21,682.49,735.08,724.38,728.59,677.54,24.95
10600,635.03,24.11,682.40,735.18,724.44,728.54,678.03,24.98
10700,634.77,23.92,682.56,735.11,724.41,728.56,677.63,25.28
10800,634.69,24.21,682.35,735.33,724.49,728.30,677.83,24.93
10900,634.91,24.30,682.53,735.31,724.35,728.48,677.71,24.95
11000,634.84,24.20,682.20,735.20,724.56,728.56,678.16,24.97
11100,636.22,24.22,682.31,734.63,724.48,728.80,679.26,24.93"""

columns = ["frame", "x0", "y0", "x1", "y1", "x2", "y2", "x3", "y3"]
df = pd.read_csv(io.StringIO(data_str), names=columns)

# Calculate difference from initial value
initial_row = df.iloc[0]
df_diff = df.copy()
for col in columns[1:]:
    df_diff[col] = df[col] - initial_row[col]

# Save to CSV
df_diff.to_csv("coordinate_differences.csv", index=False)

# Plotting
plt.figure(figsize=(12, 8))
for col in columns[1:]:
    plt.plot(df_diff["frame"], df_diff[col], label=f"$\Delta${col}")

plt.title("Difference in Meter Stick Corners from Initial Frame (Frame 100)")
plt.xlabel("Frame Number")
plt.ylabel("Difference (Pixels)")
plt.legend(bbox_to_anchor=(1.05, 1), loc='upper left')
plt.grid(True, linestyle='--', alpha=0.7)
plt.tight_layout()
plt.savefig("coordinate_diff_plot.png")

print(df_diff.head())